# Huawei Router Configuration Decryptor

This repository contains tools to decrypt Huawei HG8145B7N router configuration files from AIS with a **complete two-step decryption process**.

## üìÅ Files

- **AIS_8806480495_HG8145B7N_20251118_121144.conf** - Router configuration file (Base64-encoded, AES-encrypted)
- **hw_ctree.xml** - Corrupted binary file (not usable - damaged from opening in text editor)
- **decrypt_router_config.py** - Python script for **complete two-step decryption** (Base64 + AES)

## üîì Two-Step Decryption Process

The router configuration is protected by **two layers of encryption**:

```
[HTML/conf file] ‚Üí [Base64 encoding] ‚Üí [AES encryption] ‚Üí [XML configuration]
```

### Step 1: Base64 Extraction (Always Successful)

The script automatically extracts and decodes the Base64 data from the HTML/conf file.

### Step 2: AES Decryption (Automatic + Manual Fallback)

The script attempts automatic AES decryption with an **extensive wordlist of 737+ known keys**, including:

**Pattern-based key generation:**
- Router model variants (HG8145B7N, hg8145b7n, HuaweiHG8145B7N, etc.)
- Key-role combinations (key, KEY, aes, AES, cfg, cfgkey, config, DecKey, EncKey)
- Firmware versions (V5R023C10, V5, etc.)
- Pattern combinations:
  - `<model>_<keyrole>` (e.g., `HG8145B7N_AES`)
  - `<keyrole>_<model>` (e.g., `cfgkey_HG8145B7N`)
  - `<model><keyrole>` (e.g., `HG8145B7Nkey`)
  - `<model>_<version>_<keyrole>` (e.g., `HG8145B7N_V5R023C10_AES`)

**Common standalone keys:**
- `$HuaweiHg8245Q` (known AIS key)
- `huawei`, `Huawei`, `HUAWEI`
- `admin`, `password`
- `HuaweiONT`, `ONTUSER`
- Null key

If automatic decryption fails, the script saves a `.bin` file for manual decryption with external tools.

## üöÄ Quick Start

```bash
# Install required library for AES decryption
pip install pycryptodome

# Run the complete decryption
python decrypt_router_config.py AIS_8806480495_HG8145B7N_20251118_121144.conf
```

### Output Files

The script creates:
1. **`*_encrypted.bin`** - Encrypted binary (after Base64 decoding) - for manual decryption if needed
2. **`*_decrypted.xml`** - Fully decrypted XML configuration (if automatic AES decryption succeeds)

## üìã Usage

### Basic Usage

```bash
python decrypt_router_config.py <input_file> [output_file]
```

### Examples

```bash
# Default output filename
python decrypt_router_config.py AIS_8806480495_HG8145B7N_20251118_121144.conf

# Custom output filename
python decrypt_router_config.py AIS_8806480495_HG8145B7N_20251118_121144.conf my_config.xml
```

## üìñ What Happens

1. **Base64 Extraction**: Searches for and decodes Base64-encoded data
2. **Binary Save**: Saves encrypted binary to `.bin` file  
3. **AES Decryption**: Attempts automatic decryption with known keys
4. **Result**:
   - **Success**: Creates `.xml` file with decrypted configuration
   - **Failed**: Provides `.bin` file and manual decryption instructions

## üîê Finding Your Credentials

After successful decryption, open the XML file and search for:

### Internet Username/Password (PPPoE)
```xml
<WANPPPConnection>
  <Username>your_username</Username>
  <Password>your_password</Password>
</WANPPPConnection>
```

### WiFi Password
```xml
<WLANConfiguration>
  <PreSharedKey>your_wifi_password</PreSharedKey>
</WLANConfiguration>
```

## üîë Encryption Key Wordlist

The script generates **737+ potential encryption keys** based on common Huawei router patterns:

### Base Patterns
- Router models: `HG8145B7N`, `hg8145b7n`, `HuaweiHG8145B7N`, `AIS_HG8145B7N`, etc.
- Key roles: `key`, `KEY`, `aes`, `AES`, `cfg`, `cfgkey`, `config`, `DecKey`, `EncKey`
- Versions: `V5R023C10`, `V5`, years (2023-2025)

### Pattern Combinations
1. `<base>` - e.g., `HG8145B7N`
2. `<base>_<keyrole>` - e.g., `HG8145B7N_AES`
3. `<keyrole>_<base>` - e.g., `cfgkey_HG8145B7N`
4. `<base><keyrole>` - e.g., `HG8145B7Nkey`
5. `<base>_<year>` - e.g., `HG8145B7N_2024`
6. `<base>_<version>_<keyrole>` - e.g., `HG8145B7N_V5R023C10_AES`

This comprehensive wordlist dramatically increases the chances of successful automatic decryption.

## üõ†Ô∏è Manual AES Decryption (If Automatic Fails)

If automatic AES decryption doesn't work, use the generated `.bin` file with external tools:

1. Download a Huawei Router Config Decrypter:
   - Search GitHub for `huawei-config-utility`
   - Search for `huawei_xml_decrypt`
   - Or `Huawei Router Config Decrypter`

2. Use the `.bin` file generated by this script

3. Try these keys in the external tool:
   - `$HuaweiHg8245Q`
   - Empty/null key
   - `hg8245`
   - `huawei`
   - Model-specific keys

## üì¶ Requirements

- **Python 3.x**
- **pycryptodome** (for automatic AES decryption)
  ```bash
  pip install pycryptodome
  ```

**Note**: The script works without `pycryptodome`, but will only perform Base64 extraction and save the `.bin` file for manual decryption.

## ‚ö†Ô∏è Important Notes

- **File 1** (AIS conf): ‚úÖ Usable - Contains complete configuration data
- **File 2** (hw_ctree.xml): ‚ùå Damaged - Corrupted from text editor (Mojibake)
- The script performs **both steps** automatically when possible
- Always saves `.bin` file for manual decryption as fallback
- Keep your router credentials secure after extraction

## üîí Security Notice

This tool is for legitimate router configuration backup and recovery purposes only. Always:
- Keep your router credentials secure
- Change default passwords
- Use strong WiFi encryption
- Only decrypt your own router configurations

## üí° How It Works

1. **Base64 Layer**: Extracts and decodes Base64 data from HTML/conf file
2. **AES Layer**: Attempts decryption with multiple known Huawei router keys
3. **Decompression**: Handles zlib/gzip compression if present  
4. **Validation**: Checks for XML markers and router-specific tags
5. **Fallback**: Provides binary file and instructions if automatic decryption fails

